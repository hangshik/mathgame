
https://www.puzzle-star-battle.com/

https://puzzleresearchroom.tistory.com/entry/Star-Battle

5x5 1,2ë²ˆ(ë¬¸ì œì™€ ì •ë‹µ)
8x8 1ë²ˆ(ë¬¸ì œì™€ ì •ë‹µ)
10x10 1ë²ˆ(ë¬¸ì œë§Œ)

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Star Battle</title>
    <style>
        :root {
            --board-size: 5;
            --border-thin: 1px solid #e0e0e0;
            --border-thick: 3px solid #333;
            --color-error: #ffebee;
            --color-active: #007bff;
            --color-hint: #ffc107;
            --color-success: #28a745;
            --color-bg-solved: #e8f5e9; /* ì„±ê³µ ì‹œ ë°°ê²½ìƒ‰ (ì—°í•œ ë…¹ìƒ‰) */
            --color-dot: #b0b8c0;       /* íšŒìƒ‰ ì› ìƒ‰ìƒ */
            --bg-color: #f8f9fa;
        }

        body {
            font-family: 'Pretendard', 'Segoe UI', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: var(--bg-color);
            margin: 0;
            padding: 20px 10px;
            color: #333;
            min-height: 100vh;
        }

        h1 { margin: 0 0 20px 0; font-size: 26px; color: #2c3e50; letter-spacing: -0.5px; }

        /* --- ë ˆë²¨ íŒ¨ë„ --- */
        .level-panel {
            background: white;
            padding: 20px;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.05);
            margin-bottom: 20px;
            width: 100%;
            max-width: 500px;
            box-sizing: border-box;
        }

        .level-group { margin-bottom: 15px; }
        .level-group:last-child { margin-bottom: 0; }
        
        .level-group-title {
            font-weight: 700;
            font-size: 14px;
            margin-bottom: 8px;
            color: #666;
            display: flex;
            justify-content: space-between;
        }

        .level-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 8px;
        }

        .level-btn {
            position: relative;
            padding: 12px 0;
            background-color: #fff;
            color: #555;
            border: 1px solid #dee2e6;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.2s;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        .level-btn:hover { background-color: #f1f3f5; border-color: #ced4da; }
        
        /* í™œì„± ìƒíƒœ */
        .level-btn.active {
            background-color: var(--color-active);
            color: white;
            border-color: var(--color-active);
            box-shadow: 0 4px 10px rgba(0,123,255,0.3);
            z-index: 2;
        }
        
        /* í´ë¦¬ì–´ ìƒíƒœ (ë…¹ìƒ‰ ë°°ê²½, í°ìƒ‰ ê¸€ì”¨) */
        .level-btn.cleared { background-color: #28a745; border-color: #218838; color: white; }
        .level-btn.cleared:hover { background-color: #218838; }
        
        .level-btn.cleared::after {
            content: 'â˜…';
            position: absolute;
            top: 2px; right: 5px;
            font-size: 10px; color: #ffeb3b;
        }

        .level-btn.cleared.active { 
            background-color: #1e7e34; border-color: #1e7e34;
            box-shadow: 0 4px 10px rgba(40, 167, 69, 0.4);
        }

        .btn-record {
            font-size: 11px;
            font-weight: normal;
            margin-top: 2px;
            color: #888;
        }
        .level-btn.cleared .btn-record,
        .level-btn.active .btn-record { color: white; opacity: 0.9; }

        /* --- ì •ë³´ ë°” --- */
        .game-info-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            max-width: 500px;
            margin-bottom: 20px;
            background: white;
            padding: 15px 20px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.03);
            box-sizing: border-box;
        }
        .status-left { display: flex; flex-direction: column; gap: 4px; }
        .info-title { font-weight: bold; font-size: 16px; }
        .stars-left { font-size: 14px; font-weight: 600; color: var(--color-active); }
        .timer { font-size: 24px; font-family: 'Courier New', monospace; font-weight: 700; color: #333; }

        /* --- ë³´ë“œ --- */
        .game-board {
            /* 1. ì´ˆê¸°ì—ëŠ” ìˆ¨ê¹€ ì²˜ë¦¬ */
            display: none; 
            grid-template-columns: repeat(var(--board-size), minmax(0, 1fr));
            grid-template-rows: repeat(var(--board-size), minmax(0, 1fr));
            border: var(--border-thick);
            background-color: white;
            user-select: none;
            box-shadow: 0 8px 30px rgba(0,0,0,0.08);
            width: 100%;
            max-width: 500px;
            aspect-ratio: 1;
            margin-bottom: 25px;
            transition: background-color 0.3s ease;
        }

        /* 2. ì„±ê³µ ì‹œ ë³´ë“œ ì „ì²´ ë°°ê²½ìƒ‰ ë³€ê²½ (HTML í´ë˜ìŠ¤ ì¶”ê°€ë¡œ ì œì–´) */
        .game-board.solved-board .cell {
            background-color: var(--color-bg-solved);
        }
        /* ì„±ê³µ ìƒíƒœì—¬ë„ hover íš¨ê³¼ëŠ” ìœ ì§€í•˜ë˜, ì•½ê°„ ì–´ë‘¡ê²Œ */
        .game-board.solved-board .cell:hover {
            background-color: #dcedc8;
        }

        .cell {
            position: relative;
            border-right: var(--border-thin);
            border-bottom: var(--border-thin);
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            height: 100%;
            overflow: hidden;
            font-size: clamp(16px, 5vw, 32px);
            cursor: pointer;
            box-sizing: border-box;
            background-color: #fff;
            transition: background-color 0.1s;
        }

        .thick-right { border-right: var(--border-thick); }
        .thick-bottom { border-bottom: var(--border-thick); }

        .cell.star { color: #f39c12; text-shadow: 0 2px 0 rgba(0,0,0,0.1); }
        
        /* 3. íšŒìƒ‰ ì›(Dot) ë””ìì¸ ë³€ê²½ */
        .cell.cross {
            /* í…ìŠ¤íŠ¸(Ã—) ëŒ€ì‹  CSS ë„í˜• ì‚¬ìš© */
            color: transparent; 
        }
        .cell.cross::after {
            content: '';
            width: 30%;       /* ì…€ í¬ê¸°ì— ë¹„ë¡€ */
            height: 30%;
            background-color: var(--color-dot);
            border-radius: 50%; /* ì›í˜• */
            display: block;
        }

        /* ì˜¤ë¥˜ í‘œì‹œëŠ” ê°€ì¥ ìš°ì„ ìˆœìœ„ ë†’ê²Œ */
        .cell.error { background-color: var(--color-error) !important; }

        /* --- ì»¨íŠ¸ë¡¤ --- */
        .controls {
            display: flex;
            gap: 12px;
            width: 100%;
            max-width: 500px;
        }
        .btn-ctrl {
            flex: 1;
            padding: 14px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 700;
            font-size: 16px;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            transition: transform 0.1s, box-shadow 0.1s;
        }
        .btn-ctrl:active { transform: translateY(2px); }
        .btn-hint { background-color: var(--color-hint); color: #5a4a08; box-shadow: 0 4px 0 #d39e00; }
        .btn-reset { background-color: #6c757d; box-shadow: 0 4px 0 #545b62; }
        .btn-hint:active { box-shadow: 0 0 0 #d39e00; }
        .btn-reset:active { box-shadow: 0 0 0 #545b62; }

        /* --- ëª¨ë‹¬ --- */
        .modal-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(4px);
        }
        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 24px;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 280px;
            width: 90%;
            animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        @keyframes popIn {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        .modal-title { font-size: 32px; margin: 0 0 15px 0; color: #28a745; }
        .close-modal-btn {
            background: var(--color-active);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 50px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,123,255,0.4);
            margin-top: 20px;
        }
        .close-modal-btn:hover { background: #0056b3; }

    </style>
</head>
<body>

    <h1>Star Battle</h1>

    <div class="level-panel">
        <div class="level-group">
            <div class="level-group-title"><span>5x5 (ë³„ 1ê°œ)</span> <span>ì…ë¬¸</span></div>
            <div class="level-buttons" id="lvl-5-1"></div>
        </div>
        <div class="level-group">
            <div class="level-group-title"><span>8x8 (ë³„ 1ê°œ)</span> <span>ë³´í†µ</span></div>
            <div class="level-buttons" id="lvl-8-1"></div>
        </div>
        <div class="level-group">
            <div class="level-group-title"><span>10x10 (ë³„ 2ê°œ)</span> <span>ì–´ë ¤ì›€</span></div>
            <div class="level-buttons" id="lvl-10-2"></div>
        </div>
    </div>

    <div class="game-info-bar">
        <div class="status-left">
            <div id="statusInfo" class="info-title">ë¬¸ì œ ì„ íƒ ëŒ€ê¸°ì¤‘</div>
            <div id="starsLeft" class="stars-left">ë‚¨ì€ ë³„: -</div>
        </div>
        <div class="timer" id="timer">00:00</div>
    </div>

    <div id="board" class="game-board"></div>

    <div class="controls">
        <button class="btn-ctrl btn-hint" onclick="useHint()">
            <span>ğŸ’¡</span> íŒíŠ¸
        </button>
        <button class="btn-ctrl btn-reset" onclick="resetBoard()">
            <span>ğŸ”„</span> ì´ˆê¸°í™”
        </button>
    </div>

    <br><div style="font-size: 18px;">
      <b>[ê·œì¹™]</b><br>
      1. ê° ê°€ë¡œì¤„, ê° ì„¸ë¡œì¤„, ê·¸ë¦¬ê³  êµµì€ ì¤„ë¡œ ë‚˜ë‰œ ê° êµ¬ì—­ì— ë³„1ê°œ ë˜ëŠ” 2ê°œê°€ ë“¤ì–´ê°„ë‹¤.<br>
      2. ë³„ë“¤ì´ ì„œë¡œ ë‹¿ì•„ì„  ì•ˆ ëœë‹¤. ëŒ€ê°ì„ ìœ¼ë¡œë„ ë‹¿ì„ ìˆ˜ ì—†ë‹¤.
    </div>

    <div id="successModal" class="modal-overlay">
        <div class="modal-content" onclick="event.stopPropagation()">
            <h2 class="modal-title">ğŸ‰ Clear!</h2>
            <div style="font-size: 20px; font-weight: bold; color: #555;">
                ê¸°ë¡: <span id="currentClearTime" style="color:#28a745"></span>
            </div>
            <button class="close-modal-btn" onclick="closeModal()">í™•ì¸</button>
        </div>
    </div>

    <script>
        const LEVELS = {
            '5-1': [
                {
                    id: 1, size: 5, stars: 1,
                    solution: [1,0,0,0,0, 0,0,0,1,0, 0,1,0,0,0, 0,0,0,0,1, 0,0,1,0,0],
                    regions:  [0,1,1,1,2, 0,1,1,1,2, 3,3,2,2,2, 4,4,2,2,2, 4,4,4,4,4]
                },
                {
                    id: 2, size: 5, stars: 1,
                    solution: [0,0,0,1,0, 0,1,0,0,0, 0,0,0,0,1, 0,0,1,0,0, 1,0,0,0,0],
                    regions:  [0,0,0,1,2, 0,0,0,1,2, 3,3,3,3,2, 4,4,3,3,3, 4,4,4,4,4]
                }
            ],
            '8-1': [
                {
                    id: 1, size: 8, stars: 1,
                    solution: [
                        1,0,0,0,0,0,0,0, 0,0,1,0,0,0,0,0, 0,0,0,0,0,0,1,0, 0,1,0,0,0,0,0,0, 0,0,0,0,1,0,0,0, 0,0,0,0,0,0,0,1, 0,0,0,1,0,0,0,0, 0,0,0,0,0,1,0,0
                    ],
                    regions: [
                        0,0,0,0,0,0,0,0, 1,1,2,0,0,0,0,0, 1,1,2,2,0,0,3,0, 1,1,2,2,3,3,3,4, 1,1,2,2,5,3,5,4, 1,1,2,5,5,5,5,4, 1,1,2,6,6,6,7,4, 1,1,6,6,6,7,7,7
                    ]
                }
            ],
            '10-2': [
                {
                    id: 1, size: 10, stars: 2,
                    solution: [
                        1,0,0,0,0,1,0,0,0,0, 0,0,1,0,0,0,0,1,0,0,
                        0,0,0,0,1,0,0,0,0,1, 0,1,0,0,0,0,1,0,0,0,
                        0,0,0,1,0,0,0,0,1,0, 1,0,0,0,0,1,0,0,0,0,
                        0,0,1,0,0,0,0,1,0,0, 0,0,0,0,1,0,0,0,0,1,
                        0,1,0,0,0,0,1,0,0,0, 0,0,0,1,0,0,0,0,1,0
                    ],
                    regions: [
                        0,0,0,1,1,1,1,1,1,2, 0,1,1,1,1,1,1,2,2,2, 0,3,3,3,1,1,4,4,2,2, 0,0,0,3,3,3,4,4,2,2, 5,5,5,6,7,3,4,4,8,2, 5,5,5,6,7,3,7,4,8,2, 5,5,5,6,7,7,7,4,8,8, 5,5,5,6,6,6,6,6,6,8, 5,5,9,9,9,9,9,8,8,8, 9,9,9,9,9,8,8,8,8,8
                    ]
                }
            ]
        };

        let currentLevelData = null;
        let gridState = [];
        let gameActive = false;
        const savedStates = {}; 
        const records = {};     
        let startTime = 0;
        let timerInterval = null;
        let accumulatedTime = 0; 

        const boardElement = document.getElementById('board');
        const timerElement = document.getElementById('timer');
        const statusInfo = document.getElementById('statusInfo');
        const starsLeftElement = document.getElementById('starsLeft');
        const successModal = document.getElementById('successModal');

        function init() {
            createLevelButtons('lvl-5-1', LEVELS['5-1'], '5-1');
            createLevelButtons('lvl-8-1', LEVELS['8-1'], '8-1');
            createLevelButtons('lvl-10-2', LEVELS['10-2'], '10-2');
            successModal.onclick = closeModal;
        }

        function createLevelButtons(containerId, dataList, groupKey) {
            const container = document.getElementById(containerId);
            dataList.forEach((level) => {
                const btn = document.createElement('button');
                btn.className = 'level-btn';
                btn.id = `btn-${groupKey}-${level.id}`;
                btn.innerHTML = `
                    <span>ë¬¸ì œ ${level.id}</span>
                    <span class="btn-record" id="rec-${groupKey}-${level.id}"></span>
                `;
                btn.onclick = () => loadLevel(level, groupKey);
                container.appendChild(btn);
            });
        }

        function saveCurrentState() {
            if (!currentLevelData) return;
            const key = `${currentLevelData.groupKey}-${currentLevelData.id}`;
            const now = Date.now();
            const currentSessionTime = gameActive ? (now - startTime) : 0;
            
            savedStates[key] = {
                grid: [...gridState],
                totalTime: accumulatedTime + currentSessionTime
            };
        }

        function loadLevel(levelData, groupKey) {
            if (gameActive && currentLevelData) {
                saveCurrentState();
            }

            // 1. ë¬¸ì œ ë¡œë“œ ì‹œ ë³´ë“œ í‘œì‹œ (CSS display: grid)
            boardElement.style.display = 'grid';

            currentLevelData = { ...levelData, groupKey: groupKey };
            const key = `${groupKey}-${levelData.id}`;
            
            const alreadyCleared = (records[key] && records[key].length > 0);

            document.documentElement.style.setProperty('--board-size', levelData.size);
            statusInfo.innerText = `${levelData.size}x${levelData.size} (ë³„ ${levelData.stars}ê°œ) - ë¬¸ì œ ${levelData.id}`;
            
            updateButtonStyles(groupKey, levelData.id);
            successModal.style.display = 'none';
            stopTimer();

            if (savedStates[key]) {
                gridState = [...savedStates[key].grid];
                accumulatedTime = savedStates[key].totalTime;
            } else {
                gridState = Array(levelData.size * levelData.size).fill(0);
                accumulatedTime = 0;
            }

            // ì„±ê³µ ìƒíƒœì— ë”°ë¼ ë³´ë“œ ë°°ê²½ìƒ‰ í´ë˜ìŠ¤ í† ê¸€
            if (alreadyCleared) {
                gameActive = false; 
                timerElement.innerText = formatTime(accumulatedTime);
                boardElement.classList.add('solved-board'); // 2. ì„±ê³µ ì‹œ ì—°í•œ ë…¹ìƒ‰
            } else {
                gameActive = true; 
                startTimer();
                boardElement.classList.remove('solved-board');
            }
            
            renderBoard();
        }

        function updateButtonStyles(currentGroup, currentId) {
            document.querySelectorAll('.level-btn').forEach(btn => btn.classList.remove('active'));
            const activeBtn = document.getElementById(`btn-${currentGroup}-${currentId}`);
            if (activeBtn) activeBtn.classList.add('active');
        }

        function resetBoard() {
            if (!currentLevelData) return;
            const key = `${currentLevelData.groupKey}-${currentLevelData.id}`;
            
            if (savedStates[key]) delete savedStates[key];
            
            gridState.fill(0);
            accumulatedTime = 0;
            gameActive = true; 
            
            // ì´ˆê¸°í™” ì‹œ ì„±ê³µ ë°°ê²½ìƒ‰ ì œê±°
            boardElement.classList.remove('solved-board');
            
            stopTimer();
            startTimer();
            renderBoard();
        }

        function useHint() {
            if (!gameActive || !currentLevelData) return;

            const size = currentLevelData.size;
            const wrongStars = [];

            for (let i = 0; i < size * size; i++) {
                if (gridState[i] === 1 && currentLevelData.solution[i] === 0) {
                    wrongStars.push(i);
                }
            }

            if (wrongStars.length > 0) {
                const pick = wrongStars[Math.floor(Math.random() * wrongStars.length)];
                gridState[pick] = 2;
                renderBoard();
                return;
            }

            const emptySpots = [];
            for (let i = 0; i < size * size; i++) {
                if (currentLevelData.solution[i] === 1 && gridState[i] !== 1) {
                    emptySpots.push(i);
                }
            }

            if (emptySpots.length === 0) {
                alert("ëª¨ë“  ì •ë‹µì„ ì´ë¯¸ ì°¾ì•˜ìŠµë‹ˆë‹¤.");
                return;
            }

            const pick = emptySpots[Math.floor(Math.random() * emptySpots.length)];
            gridState[pick] = 1;
            renderBoard();
        }

        function renderBoard() {
            const size = currentLevelData.size;
            const regions = currentLevelData.regions;
            
            boardElement.innerHTML = '';

            for (let i = 0; i < size * size; i++) {
                const r = Math.floor(i / size);
                const c = i % size;

                const cell = document.createElement('div');
                cell.className = 'cell';

                if (c < size - 1 && regions[i] !== regions[i + 1]) cell.classList.add('thick-right');
                if (r < size - 1 && regions[i] !== regions[i + size]) cell.classList.add('thick-bottom');

                if (gridState[i] === 1) {
                    cell.innerText = 'â˜…';
                    cell.classList.add('star');
                } else if (gridState[i] === 2) {
                    // 3. íšŒìƒ‰ ì› (í…ìŠ¤íŠ¸ ì—†ìŒ, CSSë¡œ ì²˜ë¦¬)
                    cell.classList.add('cross');
                }

                cell.onclick = () => { if (gameActive) handleInput(i); };
                cell.oncontextmenu = (e) => {
                    e.preventDefault();
                    if (gameActive) handleRightClick(i);
                };

                boardElement.appendChild(cell);
            }

            updateStatus();
            
            if (gameActive) {
                checkErrorsAndWin();
            }
        }

        function handleInput(idx) {
            if (gridState[idx] === 0) gridState[idx] = 1;
            else if (gridState[idx] === 1) gridState[idx] = 2;
            else gridState[idx] = 0;
            renderBoard();
        }

        function handleRightClick(idx) {
            if (gridState[idx] === 0) gridState[idx] = 2;
            else if (gridState[idx] === 2) gridState[idx] = 0;
            else if (gridState[idx] === 1) gridState[idx] = 2;
            renderBoard();
        }

        function updateStatus() {
            const size = currentLevelData.size;
            const target = currentLevelData.stars;
            const currentStars = gridState.filter(v => v === 1).length;
            const remaining = (size * target) - currentStars;

            starsLeftElement.innerText = `ë‚¨ì€ ë³„: ${remaining}ê°œ`;
            if (remaining === 0) starsLeftElement.style.color = "#28a745";
            else if (remaining < 0) starsLeftElement.style.color = "#c0392b";
            else starsLeftElement.style.color = "#007bff";
        }

        function checkErrorsAndWin() {
            if (!currentLevelData || !gameActive) return;

            const size = currentLevelData.size;
            const target = currentLevelData.stars;
            const regions = currentLevelData.regions;
            const cells = boardElement.children;
            const errors = new Set();

            for (let i = 0; i < size; i++) {
                let rowStars = [], colStars = [];
                for (let k = 0; k < size; k++) {
                    if (gridState[i * size + k] === 1) rowStars.push(i * size + k);
                    if (gridState[k * size + i] === 1) colStars.push(k * size + i);
                }
                if (rowStars.length > target) rowStars.forEach(idx => errors.add(idx));
                if (colStars.length > target) colStars.forEach(idx => errors.add(idx));
            }

            const regionMap = {};
            for (let i = 0; i < size * size; i++) {
                const rid = regions[i];
                if (!regionMap[rid]) regionMap[rid] = [];
                if (gridState[i] === 1) regionMap[rid].push(i);
            }
            for (let rid in regionMap) {
                if (regionMap[rid].length > target) regionMap[rid].forEach(idx => errors.add(idx));
            }

            for (let r = 0; r < size; r++) {
                for (let c = 0; c < size; c++) {
                    const idx = r * size + c;
                    if (gridState[idx] === 1) {
                        for (let dr = -1; dr <= 1; dr++) {
                            for (let dc = -1; dc <= 1; dc++) {
                                if (dr === 0 && dc === 0) continue;
                                const nr = r + dr, nc = c + dc;
                                if (nr >= 0 && nr < size && nc >= 0 && nc < size) {
                                    const nIdx = nr * size + nc;
                                    if (gridState[nIdx] === 1) {
                                        errors.add(idx); errors.add(nIdx);
                                    }
                                }
                            }
                        }
                    }
                }
            }

            for (let i = 0; i < cells.length; i++) {
                if (errors.has(i)) cells[i].classList.add('error');
                else cells[i].classList.remove('error');
            }

            const starCount = gridState.filter(v => v === 1).length;
            if (errors.size === 0 && starCount === (size * target)) {
                gameWin();
            }
        }

        function gameWin() {
            stopTimer();
            const now = Date.now();
            accumulatedTime += (now - startTime);
            const finalTimeStr = formatTime(accumulatedTime);

            const key = `${currentLevelData.groupKey}-${currentLevelData.id}`;
            savedStates[key] = {
                grid: [...gridState],
                totalTime: accumulatedTime
            };
            
            gameActive = false;
            
            // ì„±ê³µ ì‹œ ë³´ë“œ ë°°ê²½ìƒ‰ ë³€ê²½
            boardElement.classList.add('solved-board');

            if (!records[key]) records[key] = [];
            records[key].push(finalTimeStr);
            records[key].sort(); 
            
            const btnRecord = document.getElementById(`rec-${key}`);
            if (btnRecord) btnRecord.innerText = records[key][0];

            const btn = document.getElementById(`btn-${key}`);
            if (btn) btn.classList.add('cleared');

            showSuccessModal(finalTimeStr);
        }
        
        function formatTime(ms) {
            const totalSeconds = Math.floor(ms / 1000);
            const m = String(Math.floor(totalSeconds / 60)).padStart(2, '0');
            const s = String(totalSeconds % 60).padStart(2, '0');
            return `${m}:${s}`;
        }

        function showSuccessModal(currentTime) {
            document.getElementById('currentClearTime').innerText = currentTime;
            successModal.style.display = 'flex';
        }

        function closeModal() {
            successModal.style.display = 'none';
        }

        function startTimer() {
            startTime = Date.now();
            timerInterval = setInterval(() => {
                const now = Date.now();
                const currentMs = accumulatedTime + (now - startTime);
                timerElement.innerText = formatTime(currentMs);
            }, 1000);
        }

        function stopTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
        }

        init();
    </script>
</body>
</html>