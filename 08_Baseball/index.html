<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ìˆ«ì ì•¼êµ¬ ê²Œì„</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 20px;
      background-color: #f4f4f9;
      color: #333;
      font-size: 24px;
    }
    .hidden {
      display: none;
    }
    input {
      margin: 5px;
      padding: 10px;
      font-size: 24px;
      width: 300px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    button {
      padding: 10px 20px;
      font-size: 24px;
      background-color: #007BFF;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    button:hover {
      background-color: #0056b3;
    }
    .result {
      margin-top: 20px;
      text-align: left;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
      background-color: #fff;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    .result p {
      margin: 5px 0;
      font-size: 24px;
    }

    /* ê¸°ë¡ ë°•ìŠ¤ ìŠ¤íƒ€ì¼ */
    .record-box {
      background: white;
      border: 2px solid #ccc;
      border-radius: 10px;
      width: 90%;
      max-width: 600px;
      margin: 30px auto;
      padding: 20px;
      display: none;
    }

    table {
      margin: 20px auto;
      border-collapse: collapse;
      font-size: 24px;
      width: 100%;
    }
    table, th, td {
      border: 1px solid #333;
      padding: 10px;
      text-align: center;
    }

    .reset-btn {   /* ğŸ”§ ìˆ˜ì •ë¨: ë°•ìŠ¤ ë‚´ë¶€ì— ë“¤ì–´ê°€ëŠ” ì´ˆê¸°í™” ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
      background-color: #dc3545;
      margin-top: 15px;
      width: 100%;
    }
    .reset-btn:hover {
      background-color: #b02a37;
    }

    #digit-count {
      font-size: 25px;
    }
  </style>
</head>
<body>

  <h1>ìˆ«ì ì•¼êµ¬ ê²Œì„</h1>

  <label for="digit-count">ìˆ«ìì˜ ê°œìˆ˜ë¥¼ ì„ íƒí•˜ì„¸ìš”:</label>
  <select id="digit-count">
    <option value="3">3ê°œ</option>
    <option value="4">4ê°œ</option>
  </select>
  <button id="start-game">ê²Œì„ ì‹œì‘</button>

  <div id="game-area" class="hidden">
    <p>ìˆ«ìë¥¼ ì…ë ¥í•˜ì„¸ìš”:</p>
    <input id="user-input" type="number" maxlength="4" placeholder="ì˜ˆ: 1234" style="width: 150px">
    <button id="submit-guess">ì œì¶œ</button>
    <div class="result" id="result"></div>
  </div>

  <!-- 3ê°œ ê¸°ë¡ ë°•ìŠ¤ -->
  <div id="record-box-3" class="record-box">
    <h2>3ê°œ ìˆ«ì ëˆ„ì  ê¸°ë¡</h2>
    <div id="record-table-3"></div>

    <!-- ğŸ”§ ìˆ˜ì •ë¨: ê¸°ë¡ì´ ìˆì„ ë•Œë§Œ í‘œì‹œë˜ëŠ” ì´ˆê¸°í™” ë²„íŠ¼ -->
    <button id="reset-record-3" class="reset-btn hidden">3ê°œ ê¸°ë¡ ì´ˆê¸°í™”</button>
  </div>

  <!-- 4ê°œ ê¸°ë¡ ë°•ìŠ¤ -->
  <div id="record-box-4" class="record-box">
    <h2>4ê°œ ìˆ«ì ëˆ„ì  ê¸°ë¡</h2>
    <div id="record-table-4"></div>

    <!-- ğŸ”§ ìˆ˜ì •ë¨: ê¸°ë¡ì´ ìˆì„ ë•Œë§Œ í‘œì‹œë˜ëŠ” ì´ˆê¸°í™” ë²„íŠ¼ -->
    <button id="reset-record-4" class="reset-btn hidden">4ê°œ ê¸°ë¡ ì´ˆê¸°í™”</button>
  </div>

  <script>
    document.addEventListener('contextmenu', e => e.preventDefault());

    const startGameButton = document.getElementById('start-game');
    const digitCountSelect = document.getElementById('digit-count');
    const gameArea = document.getElementById('game-area');
    const userInput = document.getElementById('user-input');
    const submitGuessButton = document.getElementById('submit-guess');
    const resultDiv = document.getElementById('result');

    const recordBox3 = document.getElementById('record-box-3');
    const recordBox4 = document.getElementById('record-box-4');
    const recordTable3 = document.getElementById('record-table-3');
    const recordTable4 = document.getElementById('record-table-4');

    const resetBtn3 = document.getElementById('reset-record-3');  // ğŸ”§
    const resetBtn4 = document.getElementById('reset-record-4');  // ğŸ”§

    let answer = '';
    let attemptCount = 0;
    let gameFinished = false;
    let digitCount = 3;

    const successRecords3 = {};
    const successRecords4 = {};

    function updateRecordTables() {
      renderRecordTable(successRecords3, recordTable3, recordBox3, resetBtn3);
      renderRecordTable(successRecords4, recordTable4, recordBox4, resetBtn4);
    }

    /* í…Œì´ë¸” ë Œë”ë§ ê³µí†µ í•¨ìˆ˜ */
    function renderRecordTable(records, tableDiv, boxDiv, resetButton) {
      const keys = Object.keys(records).map(Number).sort((a, b) => a - b);

      // ê¸°ë¡ ì—†ìŒ â†’ ë°•ìŠ¤ ìˆ¨ê¹€ + ì´ˆê¸°í™” ë²„íŠ¼ ìˆ¨ê¹€
      if (keys.length === 0) {
        boxDiv.style.display = "none";
        tableDiv.innerHTML = "";
        resetButton.classList.add("hidden");
        return;
      }

      // ê¸°ë¡ ìˆìŒ â†’ ë°•ìŠ¤ í‘œì‹œ + ì´ˆê¸°í™” ë²„íŠ¼ í‘œì‹œ
      boxDiv.style.display = "block";
      resetButton.classList.remove("hidden");

      let headerRow = "<tr><th>ì‹œë„íšŸìˆ˜</th>";
      let dataRow = "<tr><th>ì„±ê³µíšŸìˆ˜</th>";
      let total = 0;

      keys.forEach(k => {
        headerRow += `<td>${k}</td>`;
        dataRow += `<td>${records[k]}</td>`;
        total += records[k];
      });

      headerRow += "<td>í•©ê³„</td></tr>";
      dataRow += `<td>${total}</td></tr>`;

      tableDiv.innerHTML = `
        <table>
          ${headerRow}
          ${dataRow}
        </table>
      `;
    }


    function generateRandomNumber(digits) {
      const numbers = [];
      numbers.push(Math.floor(Math.random() * 9) + 1);

      while (numbers.length < digits) {
        const rd = Math.floor(Math.random() * 10);
        if (!numbers.includes(rd)) numbers.push(rd);
      }
      return numbers.join('');
    }

    function startGame() {
      digitCount = parseInt(digitCountSelect.value);

      answer = generateRandomNumber(digitCount);
      attemptCount = 0;
      gameFinished = false;

      gameArea.classList.remove('hidden');
      resultDiv.innerHTML = '';
      userInput.value = '';
      userInput.maxLength = digitCount;
      userInput.placeholder = digitCount === 3 ? "ì˜ˆ: 123" : "ì˜ˆ: 1234";

      submitGuessButton.disabled = false;
      userInput.disabled = false;

      updateRecordTables();
      setTimeout(() => userInput.focus(), 50);
    }

    startGameButton.addEventListener('click', startGame);

    function checkGuess(guess) {
      let strikes = 0, balls = 0;
      for (let i = 0; i < guess.length; i++) {
        if (guess[i] === answer[i]) strikes++;
        else if (answer.includes(guess[i])) balls++;
      }
      return { strikes, balls };
    }

    function handleSubmit() {
      if (gameFinished) return;

      const guess = userInput.value;

      if (guess.length !== answer.length || new Set(guess).size !== guess.length) {
        alert(`ì¤‘ë³µë˜ì§€ ì•ŠëŠ” ${answer.length}ìë¦¬ ìˆ«ìë¥¼ ì…ë ¥í•˜ì„¸ìš”.`);
        return;
      }

      attemptCount++;
      const { strikes, balls } = checkGuess(guess);

      const resultText = document.createElement('p');

      if (strikes === answer.length) {
        resultText.textContent = `ì •ë‹µì…ë‹ˆë‹¤! ì •ë‹µì€ ${answer}ì˜€ìŠµë‹ˆë‹¤.`;
        resultText.style.color = 'green';
        resultText.style.fontWeight = 'bold';
        resultDiv.appendChild(resultText);

        gameFinished = true;
        submitGuessButton.disabled = true;
        userInput.disabled = true;

        if (digitCount === 3) {
          successRecords3[attemptCount] = (successRecords3[attemptCount] || 0) + 1;
        } else {
          successRecords4[attemptCount] = (successRecords4[attemptCount] || 0) + 1;
        }

        updateRecordTables();
      } else {
        resultText.textContent = `${guess}: ${strikes}S ${balls}B`;
        resultDiv.appendChild(resultText);
      }

      userInput.value = '';
      userInput.focus();
    }

    submitGuessButton.addEventListener('click', handleSubmit);
    userInput.addEventListener('keypress', e => {
      if (e.key === 'Enter') handleSubmit();
    });

    /* ğŸ”§ 3ê°œ ê¸°ë¡ ì´ˆê¸°í™” ë²„íŠ¼ */
    resetBtn3.addEventListener('click', () => {
      for (let k in successRecords3) delete successRecords3[k];
      updateRecordTables();
      alert("3ê°œ ìˆ«ì ê¸°ë¡ì´ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.");
    });

    /* ğŸ”§ 4ê°œ ê¸°ë¡ ì´ˆê¸°í™” ë²„íŠ¼ */
    resetBtn4.addEventListener('click', () => {
      for (let k in successRecords4) delete successRecords4[k];
      updateRecordTables();
      alert("4ê°œ ìˆ«ì ê¸°ë¡ì´ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.");
    });

  </script>
</body>
</html>
