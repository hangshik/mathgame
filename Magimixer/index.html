<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>랜덤 숫자 계산기</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            text-align: center;
        }
        .button-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 20px;
            justify-content: center;
            max-width: 600px;
        }
        button {
            padding: 10px 20px;
            font-size: 20px;
            cursor: pointer;
            width: 80px;
            height: 40px;
            border: none;
            border-radius: 5px;
            margin: 5px;
        }
        button_new {
            padding: 10px 20px;
            font-size: 20px;
            cursor: pointer;
            width: 140px;
            height: 22px;
            border: none;
            border-radius: 5px;
            margin: 5px;
            background-color: #99ccff;
        }
        .primary {
            background-color: #007BFF;
            color: white;
        }
        .secondary {
            background-color: #28A745;
            color: white;
        }
        .disabled {
            background-color: #6c757d;
            color: #fff;
            cursor: not-allowed;
        }
        #display {
            margin-top: 20px;
            font-size: 20px;
            text-align: left;
            width: 100%;
            max-width: 600px;
        }
        #display div {
            margin-bottom: 5px;
        }
        .line-break {
            width: 100%;
            margin: 10px 0;
        }
        #button-container, #operator-container {
            width: 100%;
            max-width: 600px;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
        }
        #operator-container {
            margin-top: 10px;
        }
    </style>
</head>
<body>

    <div id="button-container" class="button-container"></div>
    <div class="line-break"></div>
    <div id="operator-container" class="button-container"></div>
    <div id="display">
        <div id="input-display">입력: </div>
        <div id="result-display">결과: </div>
    </div>

    <script>
        // 랜덤 숫자 생성 (10부터 60까지 10단위 랜덤, 나머지 5개는 1부터 6까지)
        const firstButton = [10, 20, 30, 40, 50, 60][Math.floor(Math.random() * 6)];
        const otherButtons = Array.from({ length: 5 }, () => Math.floor(Math.random() * 6) + 1);
        const numberButtons = [firstButton, ...otherButtons];

        // 연산 기호들
        const operators = ['+', '-', '*', '/', '(', ')', '^'];

        // 입력 및 결과 화면 요소
        const inputDisplay = document.getElementById('input-display');
        const resultDisplay = document.getElementById('result-display');
        
        let currentInput = '';
        let usedNumbers = new Set();
        
        // 숫자 버튼 컨테이너
        const buttonContainer = document.getElementById('button-container');
        const operatorContainer = document.getElementById('operator-container');
        
        // 버튼 요소 저장
        const buttons = [];
        
        // 숫자 버튼 생성
        numberButtons.forEach((num, index) => {
            const button = document.createElement('button');
            button.textContent = num;

            // 색상 구분 및 버튼 상태 설정
            if (index < 2) {
                button.classList.add('primary'); // 첫 번째와 두 번째 버튼
                button.disabled = true; // 비활성화
            } else {
                button.classList.add('secondary'); // 세 번째부터 여섯 번째 버튼
                button.addEventListener('click', () => {
                    if (!button.disabled) {
                        currentInput += num;
                        inputDisplay.textContent = `입력: ${currentInput}`;
                        button.disabled = true; // 한 번 클릭 후 비활성화
                        button.classList.remove('secondary'); // 색상 변경
                        button.classList.add('disabled'); // 비활성화 스타일
                        usedNumbers.add(num); // 사용한 숫자 추가
                    }
                });
            }

            buttonContainer.appendChild(button);
            buttons.push(button); // 버튼 배열에 추가
        });

        // 연산 기호 버튼 생성
        operators.forEach(op => {
            const button = document.createElement('button');
            button.textContent = op;
            button.addEventListener('click', () => {
                currentInput += ' ' + op + ' ';
                inputDisplay.textContent = `입력: ${currentInput}`;
            });
            operatorContainer.appendChild(button);
        });

        // 초기화 버튼
        const resetButton = document.createElement('button');
        resetButton.textContent = 'C';
        resetButton.addEventListener('click', () => {
            currentInput = '';
            inputDisplay.textContent = '입력: ';
            resultDisplay.textContent = '결과: ';
            usedNumbers.clear(); // 사용한 숫자 초기화
            
            // 모든 버튼 초기화
            buttons.forEach((btn, index) => {
                if (index >= 2) { // 3번부터 6번 버튼만
                    btn.disabled = false; // 활성화
                    btn.classList.remove('disabled'); // 비활성화 스타일 제거
                    btn.classList.add('secondary'); // 원래 스타일 복원
                }
            });
        });
        operatorContainer.appendChild(resetButton);

        // 한 개씩 지우기 버튼
        const backspaceButton = document.createElement('button');
        backspaceButton.textContent = '←';
        backspaceButton.addEventListener('click', () => {
            const trimmedInput = currentInput.trimEnd();
            const lastChar = trimmedInput.slice(-1); // 마지막 입력 값

            if (!isNaN(lastChar)) { // 숫자라면
                currentInput = trimmedInput.slice(0, -1); // 숫자 제거
                inputDisplay.textContent = `입력: ${currentInput}`;

                // 숫자 버튼 활성화
                for (let i = buttons.length - 1; i >= 0; i--) {
                    if (buttons[i].textContent === lastChar && buttons[i].disabled) {
                        buttons[i].disabled = false;
                        buttons[i].classList.remove('disabled');
                        buttons[i].classList.add('secondary');
                        usedNumbers.delete(Number(lastChar)); // 사용한 숫자 제거
                        break; // 한 개만 활성화
                    }
                }
            } else if (['+', '-', '*', '/', '^'].includes(lastChar)) { // 연산자라면
                currentInput = trimmedInput.slice(0, -2); // 연산자와 공백 제거
                inputDisplay.textContent = `입력: ${currentInput}`;
            }
        });
        operatorContainer.appendChild(backspaceButton);

        // 계산하기 버튼
        const calcButton = document.createElement('button');
        calcButton.textContent = '=';
        calcButton.addEventListener('click', () => {
            const hasEnabledButton = buttons.some((btn, index) => index >= 2 && !btn.disabled);

            if (hasEnabledButton) {
                resultDisplay.textContent = '결과: 모든 숫자를 사용하세요.';
                return;
            }

            try {
                const result = eval(currentInput.replace('^', '**'));
                const primarySum = buttons
                    .filter(btn => btn.classList.contains('primary'))
                    .reduce((sum, btn) => sum + Number(btn.textContent), 0);
                if (result === primarySum) {
                    resultDisplay.textContent = `결과: ${result} (정답입니다!)`;
                } else {
                    resultDisplay.textContent = `결과: ${result} (틀렸습니다. 목표값: ${primarySum})`;
                }
            } catch (e) {
                resultDisplay.textContent = '결과: 잘못된 입력';
            }
        });
        operatorContainer.appendChild(calcButton);

        // 새로운 문제 버튼
        const newProblemButton = document.createElement('button_new');
        newProblemButton.textContent = '새로운 문제';
        newProblemButton.addEventListener('click', () => {
            window.location.reload(); // 페이지를 다시 불러오는 명령어
        });
        operatorContainer.appendChild(newProblemButton);

        // 초기 화면
        inputDisplay.textContent = '입력: ';
        resultDisplay.textContent = '결과: ';
    </script>

</body>
</html>
