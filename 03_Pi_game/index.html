<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
        
    <!-- ✅ 모바일 화면 대응을 위한 뷰포트 설정 -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>파이게임</title>
    <style>
      body{
          font-size: 30px;
      }
      div {
          display: flex;
          justify-content: center;
          align-items: center;    
          margin: auto;
      }
      .container{
          display: grid;
          gap:10px;
      }
      .row{
          float: left;
      }
      .column{
          width: 60px;
          height: 60px;
          background-color: #DDDDDD;
          margin: -3px 2px -3px 2px;
          float: left;
          border-radius: 5px;
          padding: 5px;
          user-select: none;
          text-align: center;
          line-height: 60px;
          font-size: 30px;
          cursor: pointer;
      }
      #result1 {
          white-space: pre-line;
      }
      .stage-buttons {
          margin: 10px;
      }
      .stage-buttons button {
          font-size: 20px;
          margin: 5px;
          padding: 5px 15px;
          border-radius: 10px;
          cursor: pointer;
          border: none;
      }
      .highlight {
          font-weight: bold;
          color: red;
      }
    </style>
</head>
<body>
    <!-- ✅ 단계 버튼 영역 (화면 가장 위) -->
    <center id="stageButtons" class="stage-buttons">
        <button data-hearts="0" onclick="setHearts(0)">하트 0개</button>
        <button data-hearts="3" onclick="setHearts(3)">하트 3개</button>
        <button data-hearts="5" onclick="setHearts(5)">하트 5개</button>
    </center>

    <center>
      <font size=6px>파이게임</font>
        <div id="heartContainer" style="font-size: 30px; text-align: left; margin-left: 20px; display: inline-block;"></div>
          <br><br>
          <div id="result1" style="font-size:30px">게임 진행 상태</div>
    </center>

    <hr/>
    <!-- ✅ 입력된 숫자 표시 영역 -->
    <center><div id="sequenceDisplay" style="font-size:40px;">???</div></center>
    <hr/>

    <div id="area" style="font-size:30px"></div>
    
    <br><center>
    <button id="reloadButton" style="font-size:20px"> 다시 시작 </button><br>
    <font style="font-size: 22px;">◈ 키보드<br>
      0~9: 숫자 키패드<br>
    다시 시작: Space</font>
    </center>

    <script>
        // 마우스 오른쪽 버튼 클릭 금지
        document.addEventListener('contextmenu', function(e) {
          e.preventDefault();
        });

        // 파이 소수 1000자리
        const pi = [3,1,4,1,5,9,2,6,5,3,5,8,9,7,9,3,2,3,8,4,6,2,6,4,3,3,8,3,2,7,9,5,0,2,8,8,4,1,9,7,1,6,9,3,9,9,3,7,5,1,0,5,8,2,0,9,7,4,9,4,4,5,9,2,3,0,7,8,1,6,4,0,6,2,8,6,2,0,8,9,9,8,6,2,8,0,3,4,8,2,5,3,4,2,1,1,7,0,6,7,9,8,2,1,4,8,0,8,6,5,1,3,2,8,2,3,0,6,6,4,7,0,9,3,8,4,4,6,0,9,5,5,0,5,8,2,2,3,1,7,2,5,3,5,9,4,0,8,1,2,8,4,8,1,1,1,7,4,5,0,2,8,4,1,0,2,7,0,1,9,3,8,5,2,1,1,0,5,5,5,9,6,4,4,6,2,2,9,4,8,9,5,4,9,3,0,3,8,1,9,6,4,4,2,8,8,1,0,9,7,5,6,6,5,9,3,3,4,4,6,1,2,8,4,7,5,6,4,8,2,3,3,7,8,6,7,8,3,1,6,5,2,7,1,2,0,1,9,0,9,1,4,5,6,4,8,5,6,6,9,2,3,4,6,0,3,4,4,1,8,1,5,9,8,1,3,6,2,9,7,7,4,7,7,1,3,0,9,9,6,0,5,1,8,7,0,7,2,1,1,3,4,9,9,9,9,9,9,8,3,7,2,9,7,8,0,4,9,9,5,1,0,5,9,7,3,1,7,3,2,8,1,6,0,9,6,3,1,8,5,9,5,0,2,4,4,5,9,4,5,5,3,4,6,9,0,8,3,0,2,6,4,2,5,2,2,3,0,8,2,5,3,3,4,4,6,8,5,0,3,5,2,6,1,9,3,1,1,8,8,1,7,1,0,1,0,0,0,3,1,3,7,8,3,8,7,5,2,8,8,6,5,8,7,5,3,3,2,0,8,3,8,1,4,2,0,6,1,7,1,7,7,6,6,9,1,4,7,3,0,3,5,9,8,2,5,3,4,9,0,4,2,8,7,5,5,4,6,8,7,3,1,1,5,9,5,6,2,8,6,3,8,8,2,3,5,3,7,8,7,5,9,3,7,5,1,9,5,7,7,8,0,5,3,2,1,7,1,2,2,6,8,0,6,6,1,3,0,0,1,9,2,7,8,7,6,6,1,1,1,9,5,9,0,9,2,1,6,4,2,0,1,9,8,9];

        let hearts = 0;           // 현재 하트 개수
        let selectedHearts = 0;   // 선택된 하트 개수 (기본 0)
        let stop = true;
        let count = 0;
        let inputSequence = [];

        // 하트 UI 갱신
        function updateHearts() {
            let heartDisplay = "";
            for (let i = 0; i < hearts; i++) {
                heartDisplay += "❤️ ";
            }
            document.getElementById("heartContainer").innerHTML = heartDisplay;
        }

        // 단계 버튼 클릭 시
        function setHearts(n) {
            selectedHearts = n; // 선택 저장
            resetGame();        // 다시 시작
        }

        // 게임 리셋
        function resetGame() {
            hearts = selectedHearts;
            updateHearts();
            stop = true;
            count = 0;
            inputSequence = [];
            updateSequenceDisplay();
            main();
            result1.textContent = "파이게임을 시작합니다.\n 3으로 시작하세요.";
            result1.style.color = "black";

            // 버튼 색상 유지
            document.querySelectorAll("#stageButtons button").forEach(btn => {
                if (parseInt(btn.dataset.hearts) === selectedHearts) {
                    btn.style.backgroundColor = "#60a5fa";
                    btn.style.color = "white";
                } else {
                    btn.style.backgroundColor = "";
                    btn.style.color = "";
                }
            });
        }

        // 입력 표시 갱신
        function updateSequenceDisplay() {
            if (inputSequence.length === 0) {
                sequenceDisplay.innerHTML = "???";
                return;
            }
            let displaySeq = inputSequence.slice(-7);
            let html = "";
            displaySeq.forEach((num, idx) => {
                if (idx === displaySeq.length - 1) {
                    html += `<span class="highlight">${num}</span>`;
                } else {
                    html += num;
                }
            });
            sequenceDisplay.innerHTML = html + "???";
        }

        // 숫자 클릭/입력 처리
        function clickbt(nn) {
    if (!stop) return;

    if (nn == pi[count]) {   // ✅ 정답일 때만 sequenceDisplay 갱신
        inputSequence.push(nn);
        updateSequenceDisplay();

        count++;
        result1.textContent = "게임 진행중\n" + count + "번째 성공하셨습니다.";
        result1.style.color = "blue";
        document.getElementById(nn).style.backgroundColor = "green";
        setTimeout(resultreset, 200);
    } else {
        hearts--;
        updateHearts();
        document.getElementById(nn).style.backgroundColor = "gray";
        if (hearts <= 0) {
            result1.textContent = "게임 끝\n[" + count + "번째까지 성공하셨습니다.]";
            result1.style.color = "red";
            stop = false;
        }
    }
}


        // 버튼 색 초기화
        function resultreset() {
            for (let i = 0; i <= 9; i++) {
                document.getElementById(i).style.backgroundColor = "#dddddd";
            }
        }

        // 숫자 버튼 UI 생성
        function main() {
            let tag = "<div class='container'>";
            for (let j = 0; j < 2; j++) { 
              tag += "<div class='row'>";
              for (let i = 0; i < 5; i++) {
                let num = (i + j*5 + 1) % 10;
                tag += `<div class='column' id='${num}' onclick='clickbt(${num})'>${num}</div>`;
              }
              tag += "</div>";
            }
            tag += "</div>";
            area.innerHTML = tag;
        }

        // 키보드 입력 지원
        document.addEventListener("keydown", (e) => {
            if (e.key >= "0" && e.key <= "9") {
                clickbt(parseInt(e.key));
            } else if (e.code === "Space") {
                document.getElementById("reloadButton").click();
            }
        });

        // 다시 시작 버튼
        document.getElementById("reloadButton").addEventListener("click", resetGame);

        // 초기 실행
        window.onload = () => {
            resetGame();
        };
    </script>
</body>
</html>
